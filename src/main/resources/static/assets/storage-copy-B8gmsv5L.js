import{f as e,g as r}from"./admin-storage-D0L6B7uH.js";import{E as a,r as o}from"./index-B6LbRxzB.js";import{E as s}from"./request-B2kMKzxx.js";const i=a({toName:"",toKey:"",fromId:null}),t={toName:[{required:!0,message:"请输入新存储源名称",trigger:"blur"}],toKey:[{required:!0,message:"请输入新存储源别名",trigger:"blur"},{validator:(r,a,o)=>{if(null==a||""===a)return void o("请输入存储源别名");if(["admin","file","login","install","s","onedrive","api","sharepoint","s3","webdav"].includes(a))return void o(new Error("不可占用系统级名称，请修改。"));/^[\w\-]+$/.test(a)?e({storageKey:a}).then((e=>{e.data?o(new Error("该存储源别名已存在，请修改。")):o()})):o(new Error("只允许使用字母、数字、下划线、横杠"))}}]},l=o(!1),n=o(!1);function u(){const e=o(null);return{dialogVisible:l,openDialog:e=>{l.value=!0,i.fromId=e.id,i.toKey=e.key,i.toName=e.name},closeDialog:()=>{l.value=!1},formData:i,rules:t,storageCopyFormRef:e,submitForm:a=>{n.value=!0,e.value.validate((e=>{e?r(i).then((e=>{s.success("复制成功"),l.value=!1,a("close")})).finally((()=>{n.value=!1})):n.value=!1}))},saveLoading:n}}export{u};
