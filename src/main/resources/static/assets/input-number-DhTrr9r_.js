import{d as e,r as a,E as t,c as l,m as r,o as n,a8 as u,a as s,e as i,J as o,u as m,f as d,z as c,h as p,i as v,w as b,b as f,j as N,D as y,g as x}from"./index-B6LbRxzB.js";import{E as V,i as g}from"./index-KUFYR68Z.js";import{b as h,P as I,m as E,r as S,s as w,a as A,R as F,n as _,U as $,v as k,Y as j,a_ as B,E as K,X as O,aB as C,_ as z,t as D,k as M,C as P,w as T}from"./base-BBwbuMrY.js";import{b as L}from"./request-B2kMKzxx.js";import{C as Y,I as G,U}from"./event-BwRzfsZt.js";import{v as q}from"./index-Bs7CflaZ.js";const J=h({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:I,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>null===e||E(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...L(["ariaLabel"])}),R={[Y]:(e,a)=>a!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[G]:e=>E(e)||S(e),[U]:e=>E(e)||S(e)},X=e({name:"ElInputNumber"});const H=T(z(e({...X,props:J,emits:R,setup(e,{expose:h,emit:I}){const z=e,{t:T}=w(),L=A("input-number"),J=a(),R=t({currentValue:z.modelValue,userInput:null}),{formItem:X}=F(),H=l((()=>E(z.modelValue)&&z.modelValue<=z.min)),Q=l((()=>E(z.modelValue)&&z.modelValue>=z.max)),W=l((()=>{const e=re(z.step);return _(z.precision)?Math.max(re(z.modelValue),e):(z.precision,z.precision)})),Z=l((()=>z.controls&&"right"===z.controlsPosition)),ee=$(),ae=k(),te=l((()=>{if(null!==R.userInput)return R.userInput;let e=R.currentValue;if(S(e))return"";if(E(e)){if(Number.isNaN(e))return"";_(z.precision)||(e=e.toFixed(z.precision))}return e})),le=(e,a)=>{if(_(a)&&(a=W.value),0===a)return Math.round(e);let t=String(e);const l=t.indexOf(".");if(-1===l)return e;if(!t.replace(".","").split("")[l+a])return e;const r=t.length;return"5"===t.charAt(r-1)&&(t=`${t.slice(0,Math.max(0,r-1))}6`),Number.parseFloat(Number(t).toFixed(a))},re=e=>{if(S(e))return 0;const a=e.toString(),t=a.indexOf(".");let l=0;return-1!==t&&(l=a.length-t-1),l},ne=(e,a=1)=>E(e)?le(e+z.step*a):R.currentValue,ue=()=>{if(z.readonly||ae.value||Q.value)return;const e=Number(te.value)||0,a=ne(e);oe(a),I(G,R.currentValue),ve()},se=()=>{if(z.readonly||ae.value||H.value)return;const e=Number(te.value)||0,a=ne(e,-1);oe(a),I(G,R.currentValue),ve()},ie=(e,a)=>{const{max:t,min:l,step:r,precision:n,stepStrictly:u,valueOnClear:s}=z;t<l&&D("InputNumber","min should not be greater than max.");let i=Number(e);if(S(e)||Number.isNaN(i))return null;if(""===e){if(null===s)return null;i=M(s)?{min:l,max:t}[s]:s}return u&&(i=le(Math.round(i/r)*r,n),i!==e&&a&&I(U,i)),_(n)||(i=le(i,n)),(i>t||i<l)&&(i=i>t?t:l,a&&I(U,i)),i},oe=(e,a=!0)=>{var t;const l=R.currentValue,r=ie(e);a?l===r&&e||(R.userInput=null,I(U,r),l!==r&&I(Y,r,l),z.validateEvent&&(null==(t=null==X?void 0:X.validate)||t.call(X,"change").catch((e=>P()))),R.currentValue=r):I(U,r)},me=e=>{R.userInput=e;const a=""===e?null:Number(e);I(G,a),oe(a,!1)},de=e=>{const a=""!==e?Number(e):"";(E(a)&&!Number.isNaN(a)||""===e)&&oe(a),ve(),R.userInput=null},ce=e=>{I("focus",e)},pe=e=>{var a,t;R.userInput=null,g()&&null===R.currentValue&&(null==(a=J.value)?void 0:a.input)&&(J.value.input.value=""),I("blur",e),z.validateEvent&&(null==(t=null==X?void 0:X.validate)||t.call(X,"blur").catch((e=>P())))},ve=()=>{R.currentValue!==z.modelValue&&(R.currentValue=z.modelValue)},be=e=>{document.activeElement===e.target&&e.preventDefault()};return r((()=>z.modelValue),((e,a)=>{const t=ie(e,!0);null===R.userInput&&t!==a&&(R.currentValue=t)}),{immediate:!0}),n((()=>{var e;const{min:a,max:t,modelValue:l}=z,r=null==(e=J.value)?void 0:e.input;if(r.setAttribute("role","spinbutton"),Number.isFinite(t)?r.setAttribute("aria-valuemax",String(t)):r.removeAttribute("aria-valuemax"),Number.isFinite(a)?r.setAttribute("aria-valuemin",String(a)):r.removeAttribute("aria-valuemin"),r.setAttribute("aria-valuenow",R.currentValue||0===R.currentValue?String(R.currentValue):""),r.setAttribute("aria-disabled",String(ae.value)),!E(l)&&null!=l){let e=Number(l);Number.isNaN(e)&&(e=null),I(U,e)}r.addEventListener("wheel",be,{passive:!1})})),u((()=>{var e,a;const t=null==(e=J.value)?void 0:e.input;null==t||t.setAttribute("aria-valuenow",`${null!=(a=R.currentValue)?a:""}`)})),h({focus:()=>{var e,a;null==(a=null==(e=J.value)?void 0:e.focus)||a.call(e)},blur:()=>{var e,a;null==(a=null==(e=J.value)?void 0:e.blur)||a.call(e)}}),(e,a)=>(s(),i("div",{class:d([m(L).b(),m(L).m(m(ee)),m(L).is("disabled",m(ae)),m(L).is("without-controls",!e.controls),m(L).is("controls-right",m(Z))]),onDragstart:x((()=>{}),["prevent"])},[e.controls?o((s(),i("span",{key:0,role:"button","aria-label":m(T)("el.inputNumber.decrease"),class:d([m(L).e("decrease"),m(L).is("disabled",m(H))]),onKeydown:c(se,["enter"])},[p(e.$slots,"decrease-icon",{},(()=>[v(m(K),null,{default:b((()=>[m(Z)?(s(),f(m(j),{key:0})):(s(),f(m(B),{key:1}))])),_:1})]))],42,["aria-label","onKeydown"])),[[m(q),se]]):N("v-if",!0),e.controls?o((s(),i("span",{key:1,role:"button","aria-label":m(T)("el.inputNumber.increase"),class:d([m(L).e("increase"),m(L).is("disabled",m(Q))]),onKeydown:c(ue,["enter"])},[p(e.$slots,"increase-icon",{},(()=>[v(m(K),null,{default:b((()=>[m(Z)?(s(),f(m(O),{key:0})):(s(),f(m(C),{key:1}))])),_:1})]))],42,["aria-label","onKeydown"])),[[m(q),ue]]):N("v-if",!0),v(m(V),{id:e.id,ref_key:"input",ref:J,type:"number",step:e.step,"model-value":m(te),placeholder:e.placeholder,readonly:e.readonly,disabled:m(ae),size:m(ee),max:e.max,min:e.min,name:e.name,"aria-label":e.ariaLabel,"validate-event":!1,onKeydown:[c(x(ue,["prevent"]),["up"]),c(x(se,["prevent"]),["down"])],onBlur:pe,onFocus:ce,onInput:me,onChange:de},y({_:2},[e.$slots.prefix?{name:"prefix",fn:b((()=>[p(e.$slots,"prefix")]))}:void 0,e.$slots.suffix?{name:"suffix",fn:b((()=>[p(e.$slots,"suffix")]))}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}}),[["__file","input-number.vue"]]));export{H as E};
