import{u as e}from"./useFileUpload-DuqU_uzX.js";import{o as t,a as i,e as o,P as r,Q as s,k as a}from"./index-B6LbRxzB.js";import{_ as n}from"./plugin-vue_export-helper-BCo6x5W8.js";import{E as d}from"./request-B2kMKzxx.js";import"./common-B1W1rpUW.js";import"./useCommon-CGwVn2w-.js";import"./index-X5TNrnOa.js";import"./base-BBwbuMrY.js";import"./checkbox-C28m1aVK.js";import"./event-BwRzfsZt.js";import"./index-CfE48oVh.js";import"./_Uint8Array-FYYXr4ha.js";/* empty css              */import"./index-KUFYR68Z.js";import"./use-outside-click-ez4SFYwU.js";import"./directive-c3Zp8yaa.js";import"./XCircleIcon-C5fQ6vrv.js";import"./index-XSoVjJxG.js";import"./index-58WTuj8x.js";import"./scroll-Ck97Tz0c.js";import"./index-Cd2l2kYr.js";import"./validator-EOLRKd5b.js";const m={class:"zfile-office-viewer"},p=[(e=>(r("data-v-6501dc28"),e=e(),s(),e))((()=>a("div",{id:"office-body"},null,-1)))],c=n({__name:"OfficeViewer",props:{fileUrl:String,fileName:String},setup(r){const s=r;let a=e();return t((()=>{!function(e,t){let i=document.createElement("script"),o=document.getElementsByTagName("head")[0];i.type="text/javascript",i.charset="UTF-8",i.src=e,i.addEventListener?(i.addEventListener("load",(function(){t()}),!1),i.addEventListener("error",(function(){d.warning("调用在线文档服务失败，请检查在线文档服务是否正常")}),!1)):i.attachEvent&&i.attachEvent("onreadystatechange",(function(){"loaded"===window.event.srcElement.readyState&&t()}));o.appendChild(i)}(`${a.globalConfig.onlyOfficeUrl}/web-apps/apps/api/documents/api.js`,(()=>{const e=s.fileName.lastIndexOf("."),t={document:{fileType:s.fileName.substr(e+1),title:s.fileName,url:s.fileUrl,lang:"zh-CN"},width:"100%",editorConfig:{mode:"view",lang:"zh-CN"}};new DocsAPI.DocEditor("office-body",t)}))})),(e,t)=>(i(),o("div",m,p))}},[["__scopeId","data-v-6501dc28"]]);export{c as default};
