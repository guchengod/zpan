import{au as e,G as a,aC as o,H as l}from"./base-BBwbuMrY.js";/* empty css                */import{Z as t,a as i}from"./ZFormItem-DqyrjkCI.js";/* empty css              */import{E as r}from"./input-number-DhTrr9r_.js";import{E as n}from"./radio-CZQuNt_K.js";import"./popper-CF2HgFfE.js";/* empty css                *//* empty css               */import{a as s,e as d,k as m,$ as u,H as p,r as c,m as f,u as v,J as g,b as x,w as V,N as w,i as L,K as h,t as _,j as b,P as j,Q as H}from"./index-B6LbRxzB.js";import{l as U,e as k}from"./admin-setting-DFIt9dmd.js";import{E as z}from"./request-B2kMKzxx.js";import{b as y}from"./route-block-B_A1xBdJ.js";import{_ as C}from"./plugin-vue_export-helper-BCo6x5W8.js";import{r as M}from"./CheckBadgeIcon-Cn-PgIwF.js";import{E as N}from"./index-KUFYR68Z.js";import{E as D}from"./index-C654Z3N4.js";import{v as B}from"./directive-c3Zp8yaa.js";import"./event-BwRzfsZt.js";import"./index-Bs7CflaZ.js";import"./index-Cd2l2kYr.js";import"./dropdown-DRLF-PuJ.js";function A(e,a){return s(),d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[m("path",{"fill-rule":"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z","clip-rule":"evenodd"})])}function E(e,a){return s(),d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[m("path",{d:"M11.47 3.84a.75.75 0 011.06 0l8.69 8.69a.75.75 0 101.06-1.06l-8.689-8.69a2.25 2.25 0 00-3.182 0l-8.69 8.69a.75.75 0 001.061 1.06l8.69-8.69z"}),m("path",{d:"M12 5.432l8.159 8.159c.03.03.06.058.091.086v6.198c0 1.035-.84 1.875-1.875 1.875H15a.75.75 0 01-.75-.75v-4.5a.75.75 0 00-.75-.75h-3a.75.75 0 00-.75.75V21a.75.75 0 01-.75.75H5.625a1.875 1.875 0 01-1.875-1.875v-6.198a2.29 2.29 0 00.091-.086L12 5.43z"})])}function F(e,a){return s(),d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[m("path",{"fill-rule":"evenodd",d:"M1.5 6a2.25 2.25 0 012.25-2.25h16.5A2.25 2.25 0 0122.5 6v12a2.25 2.25 0 01-2.25 2.25H3.75A2.25 2.25 0 011.5 18V6zM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0021 18v-1.94l-2.69-2.689a1.5 1.5 0 00-2.12 0l-.88.879.97.97a.75.75 0 11-1.06 1.06l-5.16-5.159a1.5 1.5 0 00-2.12 0L3 16.061zm10.125-7.81a1.125 1.125 0 112.25 0 1.125 1.125 0 01-2.25 0z","clip-rule":"evenodd"})])}function T(e,a){return s(),d("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[m("path",{"fill-rule":"evenodd",d:"M12.516 2.17a.75.75 0 00-1.032 0 11.209 11.209 0 01-7.877 3.08.75.75 0 00-.722.515A12.74 12.74 0 002.25 9.75c0 5.942 4.064 10.933 9.563 12.348a.749.749 0 00.374 0c5.499-1.415 9.563-6.406 9.563-12.348 0-1.39-.223-2.73-.635-3.985a.75.75 0 00-.722-.516l-.143.001c-2.996 0-5.717-1.17-7.734-3.08zm3.094 8.016a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z","clip-rule":"evenodd"})])}const q=e=>(j("data-v-d5333aa8"),e=e(),H(),e),I={class:"mt-2"},S=q((()=>m("span",{class:"text-red-500 text-sm"},"设置异常，点击查看",-1))),G={class:"text-sm"},J={class:"mb-2"},P={class:"text-red-500"},Z={class:"flex justify-end"},K={class:"mt-2"},O=q((()=>m("span",{class:"text-red-500 text-sm"},"设置异常，点击查看",-1))),Q={class:"text-sm"},R={class:"mb-2"},$={class:"text-red-500"},W={class:"flex justify-end"},X={__name:"site-setting",setup(d){let j=p();const{data:H,dataLoading:y,saveData:C,saveLoading:q}=function(){const{data:e,loading:a,reload:o}=u(U,{formatResult:e=>e.data}),{loading:l,run:t}=u(k,{manual:!0,onSuccess(){z({message:"保存成功",type:"success"})}});return{data:e,dataLoading:a,reload:o,saveData:()=>{t(e.value)},saveLoading:l}}();let X=c({siteName:[{required:!0,message:"请输入站点名称"}],faviconUrl:[{type:"url",message:"请输入正确的 favicon 地址，需以 http 或 https 开头"}],domain:[{required:!0,message:"请输入后端站点域名"}],frontDomain:[],avatar:[{type:"url",message:"请输入正确的头像地址，需以 http 或 https 开头"}]});const Y=c(),ee=()=>{document.querySelector(".z-form").click(),Y.value.validate((e=>{e&&C()}))};let ae=c({flag:!1,except:"",action:()=>{}}),oe=c({flag:!1,except:"",action:()=>{}});return f((()=>y.value),((e,a)=>{if(!0===a){let e=j.zfileConfig.baseUrl||window.location.origin,a=H.value.domain;e!==a&&(ae.value.flag=!0,ae.value.current=a,ae.value.except=e,ae.value.action=()=>{H.value.domain=e,ee(),ae.value.flag=!1});let o=H.value.frontDomain,l=window.location.origin;""!==j.zfileConfig.baseUrl&&o!==l?(oe.value.flag=!0,oe.value.current=o,oe.value.except=l,oe.value.action=()=>{H.value.frontDomain=l,ee(),oe.value.flag=!1}):""===j.zfileConfig.baseUrl&&o&&(oe.value.flag=!0,oe.value.current=o,oe.value.except="空",oe.value.action=()=>{H.value.frontDomain="",ee(),oe.value.flag=!1})}})),(d,u)=>{const p=N,c=t,f=l,j=D,U=n,k=r,z=i,y=B;return v(H)?g((s(),x(z,{key:0,model:v(H),rules:v(X),ref_key:"siteSettingForm",ref:Y},{"form-title":V((()=>[w(" 站点信息 ")])),"form-sub-title":V((()=>[w(" 请填写您的站点信息 ")])),footer:V((()=>[L(f,{type:"primary",size:"default",icon:v(M),onClick:ee},{default:V((()=>[w("保存设置")])),_:1},8,["icon"])])),default:V((()=>[L(c,{prop:"siteName",label:"站点名称"},{default:V((()=>[L(p,{id:"siteName","prefix-icon":v(e),modelValue:v(H).siteName,"onUpdate:modelValue":u[0]||(u[0]=e=>v(H).siteName=e)},null,8,["prefix-icon","modelValue"])])),_:1}),L(c,{prop:"faviconUrl",label:"站点 favicon"},{tips:V((()=>[w("网站在浏览器标题栏的 favicon 图标，需确保输入的地址没有 referer 防盗链，如修改后不生效请清理浏览器缓存或再试。")])),default:V((()=>[L(p,{id:"faviconUrl","prefix-icon":v(e),modelValue:v(H).faviconUrl,"onUpdate:modelValue":u[1]||(u[1]=e=>v(H).faviconUrl=e)},null,8,["prefix-icon","modelValue"])])),_:1}),L(c,{prop:"domain",label:"后端站点域名"},{tips:V((()=>[w("此地址用于生成直链及本次存储下载使用，请务必保持和服务端地址一样 (需写 http(s):// 协议头)")])),default:V((()=>[L(p,{id:"domain","prefix-icon":v(a),modelValue:v(H).domain,"onUpdate:modelValue":u[2]||(u[2]=e=>v(H).domain=e)},null,8,["prefix-icon","modelValue"]),L(j,{placement:"right",width:400,trigger:"click"},{reference:V((()=>[g(m("div",I,[S,L(v(A),{class:"inline w-5 text-red-500"})],512),[[h,v(ae).flag]])])),default:V((()=>[m("div",G,[m("div",J,[w(" 检测到设置异常，实际后端域名应为 "),m("span",P,_(v(ae).except),1),w("，是否需要修复？（不修正可能会影响下载、文件夹加密和文档预览功能） ")]),m("div",Z,[L(f,{size:"small",type:"warning",icon:v(M),onClick:v(ae).action},{default:V((()=>[w("自动修正")])),_:1},8,["icon","onClick"])])])])),_:1})])),_:1}),L(c,{prop:"frontDomain",label:"前端站点域名"},{tips:V((()=>[w("前后端分离后，需配置此地址，会影响 401、403、404 页面的跳转 (需写 http(s):// 协议头，未前后端分离请保持为空)")])),default:V((()=>[L(p,{"prefix-icon":v(a),modelValue:v(H).frontDomain,"onUpdate:modelValue":u[3]||(u[3]=e=>v(H).frontDomain=e)},null,8,["prefix-icon","modelValue"]),L(j,{placement:"right",width:400,trigger:"click"},{reference:V((()=>[g(m("div",K,[O,L(v(A),{class:"inline w-5 text-red-500"})],512),[[h,v(oe).flag]])])),default:V((()=>[m("div",Q,[m("div",R,[w(" 检测到设置异常，实际前端域名应为 "),m("span",$,_(v(oe).except),1),w("，是否需要修复？（不修正会影响 401、403、404 页面的跳转功能） ")]),m("div",W,[L(f,{size:"small",type:"warning",icon:v(M),onClick:v(oe).action},{default:V((()=>[w("自动修正")])),_:1},8,["icon","onClick"])])])])),_:1})])),_:1}),L(c,{prop:"avatar",label:"头像地址"},{tips:V((()=>[w("用于管理员页面右上角头像地址，推荐尺寸为 35 * 35.")])),default:V((()=>[L(p,{id:"avatar","prefix-icon":v(o),modelValue:v(H).avatar,"onUpdate:modelValue":u[4]||(u[4]=e=>v(H).avatar=e)},null,8,["prefix-icon","modelValue"])])),_:1}),L(c,{prop:"siteHomeName",label:"根路径名称"},{tips:V((()=>[w("用于设置首页上方面包屑根目录的默认名称.")])),default:V((()=>[L(p,{id:"siteHomeName","prefix-icon":v(E),modelValue:v(H).siteHomeName,"onUpdate:modelValue":u[5]||(u[5]=e=>v(H).siteHomeName=e)},null,8,["prefix-icon","modelValue"])])),_:1}),L(c,{prop:"siteHomeLogo",label:"首页 Logo 图片地址"},{tips:V((()=>[w("用于设置首页上面包屑左侧 Logo，留空为不显示，会自动居中显示，如有需要可通过自定义 css 来修改默认样式, logo 元素的 id 为 zfile-home-logo")])),default:V((()=>[L(p,{id:"siteHomeLogo","prefix-icon":v(F),modelValue:v(H).siteHomeLogo,"onUpdate:modelValue":u[6]||(u[6]=e=>v(H).siteHomeLogo=e)},null,8,["prefix-icon","modelValue"])])),_:1}),L(c,{prop:"siteHomeLogoLink",label:"首页 Logo 打开链接"},{tips:V((()=>[w("点击 Logo 链接后打开的地址，为空则点击不进行任何跳转")])),default:V((()=>[L(p,{id:"siteHomeLogoLink","prefix-icon":v(a),modelValue:v(H).siteHomeLogoLink,"onUpdate:modelValue":u[7]||(u[7]=e=>v(H).siteHomeLogoLink=e)},null,8,["prefix-icon","modelValue"])])),_:1}),L(c,{prop:"siteHomeLogoTargetMode",label:"首页 Logo 链接打开方式"},{tips:V((()=>[w("控制 Logo 链接的打开方式")])),default:V((()=>[L(U,{modelValue:v(H).siteHomeLogoTargetMode,"onUpdate:modelValue":u[8]||(u[8]=e=>v(H).siteHomeLogoTargetMode=e),label:"_blank"},{default:V((()=>[w("新标签打开")])),_:1},8,["modelValue"]),L(U,{modelValue:v(H).siteHomeLogoTargetMode,"onUpdate:modelValue":u[9]||(u[9]=e=>v(H).siteHomeLogoTargetMode=e),label:"_self"},{default:V((()=>[w("当前页面打开")])),_:1},8,["modelValue"])])),_:1}),L(c,{label:"备案号"},{default:V((()=>[L(p,{id:"icp","prefix-icon":v(T),modelValue:v(H).icp,"onUpdate:modelValue":u[10]||(u[10]=e=>v(H).icp=e)},null,8,["prefix-icon","modelValue"])])),_:1}),L(c,{label:"最大同时上传文件数"},{default:V((()=>[L(k,{id:"maxFileUploads",modelValue:v(H).maxFileUploads,"onUpdate:modelValue":u[11]||(u[11]=e=>v(H).maxFileUploads=e),min:1,max:99},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])),[[y,v(q)]]):b("",!0)}}};"function"==typeof y&&y(X);const Y=C(X,[["__scopeId","data-v-d5333aa8"]]);export{Y as default};
