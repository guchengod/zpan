import{S as e}from"./index-KUFYR68Z.js";import{_ as r}from"./plugin-vue_export-helper-BCo6x5W8.js";import{r as t,c as s,a as o,e as l,k as a,h as m,o as i,C as p,f as d,u,t as f,j as n,Z as v}from"./index-B6LbRxzB.js";const c={class:"z-form"},g={class:"space-y-8 divide-y divide-gray-200"},x={class:"z-form-body"},y={class:"z-form-title text-lg leading-6 font-medium text-gray-900"},b={class:"z-form-sub-title mt-2 max-w-3xl text-sm text-gray-500"},h={class:"z-form-footer"},q={class:"pt-5"},j={class:"flex justify-end"},z={name:"ZForm"},E=r(Object.assign(z,{props:{model:Object,rules:Object},setup(r,{expose:i}){const p=r;let d=t({}),u=t([]),f=s((()=>{const e={};return u.value.forEach((({prop:r,required:t,label:s})=>{t&&(e[r]=[{required:!0,message:`${s}不能为空`}]),void 0!==p.rules[r]&&(Array.isArray(p.rules[r])?e[r]=p.rules[r]:e[r]=[{required:!0}])})),e})),n=s((()=>u.value.reduce(((e,{prop:r})=>{let t=r.split(".");if(t.length>1){let s=p.model;for(;t.length>=1;){let e=t.shift();void 0!==s[e]&&(s=s[e])}e[r]=s}else e[r]=p.model[r];return e}),{})));return i({validate:r=>{new e(f.value).validate(n.value,(e=>{let t={};e&&e.length?e.forEach((({message:e,field:r})=>{t[r]=e})):t={},d.value=t,r(0===Object.keys(t).length)}))},formAddField:e=>{e&&(u.value=[...u.value,e])},formRemoveField:e=>{e&&(u.value=u.value.filter((({prop:r})=>r!==e.prop)))},rulesArray:s((()=>p.rules)),formError:d}),(e,r)=>(o(),l("form",c,[a("div",g,[a("div",x,[a("div",null,[a("h3",y,[m(e.$slots,"form-title",{},void 0,!0)]),a("p",b,[m(e.$slots,"form-sub-title",{},void 0,!0)])]),m(e.$slots,"default",{},void 0,!0)]),a("div",h,[a("div",q,[a("div",j,[m(e.$slots,"footer",{},void 0,!0)])])])])]))}}),[["__scopeId","data-v-cd044600"]]),$={class:"sm:grid sm:grid-cols-3 sm:gap-4 sm:items-start sm:border-t sm:border-gray-200 sm:pt-5"},_=["for"],F={class:"mt-1 sm:mt-0 sm:col-span-2"},A={class:"empty:mt-0 mt-2 text-sm max-w-2xl text-gray-400 z-form-item-tips"},k={class:"empty:mt-0 mt-2 text-sm text-red-500"},w=r({__name:"ZFormItem",props:{required:Boolean,prop:String,label:String},setup(r){const c=r,{proxy:g}=v();let x=s((()=>{let e=b.value.rulesArray;return e?e[c.prop]:[]})),y=s((()=>{if(c.required)return!0;if(x.value)for(let e=0;e<x.value.length;e++){let r=x.value[e].required;if("boolean"==typeof r)return!0;if("function"==typeof r)return r()}return!1})),b=s((()=>{let e=g.$parent;for(;"ZForm"!==e.$options.name;)e=e.parent;return e}));s((()=>{if(!c.prop)return"";return b.value.formError[c.prop]||""}));const h=(e,r)=>{b.value[e](r)};let q=t();i((()=>{c.prop&&h("formAddField",{prop:c.prop,required:c.required,label:c.label,el:q.value})})),p((()=>{h("formRemoveField",{prop:c.prop})}));const j=r=>{let t=r.target.value,s={},o={};x.value&&(s[c.prop]=x.value,o[c.prop]=t);new e(s).validate(o,(e=>{e&&e.length?e.forEach((({message:e,field:r})=>{b.value.formError[c.prop]=e})):b.value.formError[c.prop]=""}))};return(e,t)=>(o(),l("div",{ref_key:"zFormItem",ref:q,class:d([u(b).formError[c.prop]?"is-error":"is-success","z-form-item mt-6 sm:mt-5 space-y-6 sm:space-y-5"])},[a("div",$,[r.label?(o(),l("label",{key:0,for:c.prop,class:d([u(y)?"required":"not-required","block text-sm font-medium text-gray-700 sm:mt-px sm:pt-2"])},f(r.label),11,_)):n("",!0),a("div",F,[a("div",{class:"input max-w-2xl flex rounded-md z-form-item-input",onInput:j},[m(e.$slots,"default",{},void 0,!0)],32),a("p",A,[m(e.$slots,"tips",{},void 0,!0)]),a("p",k,f(u(b).formError[c.prop]),1)])])],2))}},[["__scopeId","data-v-7be0a7a0"]]);export{w as Z,E as a};
