import{H as e}from"./base-BBwbuMrY.js";/* empty css                */import{Z as l,a}from"./ZFormItem-DqyrjkCI.js";/* empty css               *//* empty css              */import{E as t}from"./input-number-DhTrr9r_.js";import{E as o}from"./radio-CZQuNt_K.js";import"./tag-CxKPM5Nx.js";import{E as n,a as r}from"./select-D4OJKeW_.js";import"./scrollbar-Cg0Qc4lf.js";import"./popper-CF2HgFfE.js";import{a as s,e as u,k as i,r as d,m as p,F as m,v as f,i as c,u as v,w as b,b as h,J as V,K as x,t as w,N as g,j as y,O as k}from"./index-B6LbRxzB.js";import{g as j,a as _}from"./unit-DqtDPlxk.js";import{E as P}from"./switch-DP8XpaVB.js";import{u as U}from"./useLinkSetting-D8Br4RFU.js";import{a as T,t as C}from"./admin-setting-DFIt9dmd.js";import{u as L}from"./index-X5TNrnOa.js";import{r as I,a as z}from"./XCircleIcon-C5fQ6vrv.js";import{E}from"./index-KUFYR68Z.js";import{v as F}from"./directive-c3Zp8yaa.js";import"./plugin-vue_export-helper-BCo6x5W8.js";import"./request-B2kMKzxx.js";import"./event-BwRzfsZt.js";import"./index-Bs7CflaZ.js";import"./castArray-Cx7RYULx.js";import"./scroll-Ck97Tz0c.js";import"./index-CfE48oVh.js";import"./_Uint8Array-FYYXr4ha.js";import"./debounce-Da1en5bL.js";import"./index-Cd2l2kYr.js";import"./validator-EOLRKd5b.js";function R(e,l){return s(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M12 2.25a.75.75 0 01.75.75v16.19l6.22-6.22a.75.75 0 111.06 1.06l-7.5 7.5a.75.75 0 01-1.06 0l-7.5-7.5a.75.75 0 111.06-1.06l6.22 6.22V3a.75.75 0 01.75-.75z","clip-rule":"evenodd"})])}function A(e,l){return s(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M11.47 2.47a.75.75 0 011.06 0l7.5 7.5a.75.75 0 11-1.06 1.06l-6.22-6.22V21a.75.75 0 01-1.5 0V4.81l-6.22 6.22a.75.75 0 11-1.06-1.06l7.5-7.5z","clip-rule":"evenodd"})])}function D(e,l){return s(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M3.75 12a.75.75 0 01.75-.75h15a.75.75 0 010 1.5h-15a.75.75 0 01-.75-.75z","clip-rule":"evenodd"})])}function Z(e,l){return s(),u("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true"},[i("path",{"fill-rule":"evenodd",d:"M12 3.75a.75.75 0 01.75.75v6.75h6.75a.75.75 0 010 1.5h-6.75v6.75a.75.75 0 01-1.5 0v-6.75H4.5a.75.75 0 010-1.5h6.75V4.5a.75.75 0 01.75-.75z","clip-rule":"evenodd"})])}const H={class:"flex flex-wrap"},M={class:"flex items-center"},S=["onClick"],B=["onClick"],O=["onClick"],X=["onClick"],N={class:"ml-3 text-gray-500"},q={__name:"TimePicker",props:{modelValue:{type:Array,required:!0}},emits:["update:modelValue"],setup(e,{emit:l}){const a=e,o=d(a.modelValue?a.modelValue:[{value:"1",unit:"d",second:86400}]);p(o,(e=>{l("update:modelValue",e)}));return(e,l)=>{const a=t,d=n,p=r;return s(),u("div",H,[(s(!0),u(m,null,f(o.value,((e,l)=>(s(),u("div",{key:l,class:"mb-4 w-full"},[i("div",M,[c(a,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,min:1,max:v(j)(e.unit),disabled:"forever"===e.unit},null,8,["modelValue","onUpdate:modelValue","max","disabled"]),c(p,{modelValue:e.unit,"onUpdate:modelValue":l=>e.unit=l,"fit-input-width":"",class:"ml-3 w-20"},{default:b((()=>[(s(!0),u(m,null,f(v(_),(e=>(s(),h(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),V(i("button",{type:"button",onClick:e=>(e=>{if(0===e)return;const l=o.value[e];o.value.splice(e,1),o.value.splice(e-1,0,l)})(l),class:"ml-2 py-2 px-2 rounded-md bg-blue-500 text-white hover:bg-blue-600 focus:bg-blue-700 focus:outline-none font-bold"},[c(v(A),{class:"h-4"})],8,S),[[x,0!==l]]),V(i("button",{type:"button",onClick:e=>(e=>{if(e===o.value.length-1)return;const l=o.value[e];o.value.splice(e,1),o.value.splice(e+1,0,l)})(l),class:"ml-2 py-2 px-2 rounded-md bg-blue-500 text-white hover:bg-blue-600 focus:bg-blue-700 focus:outline-none font-bold"},[c(v(R),{class:"h-4"})],8,B),[[x,l!==o.value.length-1]]),V(i("button",{type:"button",onClick:e=>(e=>{o.value.splice(e,0,{value:"",unit:"s"})})(l+1),class:"ml-2 py-2 px-2 rounded-md bg-blue-500 text-white hover:bg-blue-600 focus:bg-blue-700 focus:outline-none font-bold"},[c(v(Z),{class:"h-4"})],8,O),[[x,l===o.value.length-1]]),V(i("button",{type:"button",onClick:e=>(e=>{o.value.splice(e,1)})(l),class:"ml-2 py-2 px-2 rounded-md bg-red-500 text-white hover:bg-red-600 focus:bg-red-700 focus:outline-none font-bold"},[c(v(D),{class:"h-4"})],8,X),[[x,o.value.length>1]])]),i("small",N,w(e.formatted),1)])))),128))])}}},J={class:"zfile-admin-down-link-body"},W={class:"text-red-400 font-bold"},G=i("ul",null,[i("li",null,[g(" 限制泛域名 "),i("span",{class:"text-red-400"},"http 协议"),g(" 全部子目录可访问： "),i("div",{class:"inline select-all font-bold"},[i("span",{class:"text-red-400"},"http://"),g("*example.com/** ")])]),i("li",null,[g(" 限制泛域名 "),i("span",{class:"text-red-400"},"https 协议"),g(" 全部子目录可访问： "),i("div",{class:"inline select-all font-bold"},[i("span",{class:"text-red-400"},"https://"),g("*example.com/** ")])]),i("li",null,[g(" 限制泛域名 "),i("span",{class:"text-red-400"},"全部协议"),g(" 全部子目录可访问： "),i("div",{class:"inline select-all font-bold"},[i("span",{class:"text-red-400"},"*://"),g("*example.com/** ")])])],-1),K={key:0},$={key:1},Q={class:"mt-4"},Y=i("div",null," 可在下方输入你要测试的地址（应包含协议，路径，从浏览器地址栏复制就是了） ",-1),ee=i("span",null,"单 IP",-1),le=i("span",null,"秒内允许下载",-1),ae=i("span",null,"次",-1),te=i("span",null,"设置直链防止恶意下载，单 IP N 秒内只允许访问 M 次直链，如其中一个为 0 则不做任何限制.",-1),oe=i("br",null,null,-1),ne=i("br",null,null,-1),re=i("span",null,"注意：此功能对直链、短链都有效，且共享限制次数。但直链/短链跳转后的实际下载链接无法限制，因为那些链接不经过 ZFile.",-1),se=i("br",null,null,-1),ue=i("br",null,null,-1),ie={class:"text-blue-400"},de={class:"dialog-footer"},pe={__name:"basic-setting",setup(n){const{data:r,saveData:p,saveLoading:m}=U(),f=d("");T().then((e=>{f.value=e.data.data}));const j=d(""),_=d(null),R=L((()=>{let e={antPath:r?.value?.refererValue,testPath:j.value};C(e).then((e=>{_.value=e.data.data}))}),250);return(n,d)=>{const U=P,T=l,C=E,L=q,A=o,D=t,Z=e,H=a,M=F;return s(),u("div",J,[v(r)?V((s(),h(H,{key:0,model:v(r),"element-loading-text":"保存中..."},{"form-title":b((()=>[g(" 直/短链设置 ")])),"form-sub-title":b((()=>[g(" 这里可以配置直/短链相关设置 ")])),footer:b((()=>[i("span",de,[c(Z,{type:"primary",onClick:v(p)},{default:b((()=>[g("保存")])),_:1},8,["onClick"])])])),default:b((()=>[c(T,{label:"记录下载日志"},{tips:b((()=>[g(" 是否记录直/短链下载日志 ")])),default:b((()=>[c(U,{modelValue:v(r).recordDownloadLog,"onUpdate:modelValue":d[0]||(d[0]=e=>v(r).recordDownloadLog=e)},null,8,["modelValue"])])),_:1}),c(T,{label:"是否允许生成/使用直链（路径）"},{tips:b((()=>[g(" 控制是否生成直链时显示直链路径及是否允许使用直链进行下载. ")])),default:b((()=>[c(U,{modelValue:v(r).showPathLink,"onUpdate:modelValue":d[1]||(d[1]=e=>v(r).showPathLink=e)},null,8,["modelValue"])])),_:1}),c(T,{label:"直链地址前缀"},{tips:b((()=>[g(" 直链地址前缀, 如 http(s)://ip:port/"),i("span",W,w(v(r).directLinkPrefix),1),g("/path/filename ")])),default:b((()=>[c(C,{modelValue:v(r).directLinkPrefix,"onUpdate:modelValue":d[2]||(d[2]=e=>v(r).directLinkPrefix=e)},null,8,["modelValue"])])),_:1}),c(T,{label:"是否允许使用短链"},{tips:b((()=>[g(" 控制是否生成直链时显示短链路径及是否允许使用短链进行下载 ")])),default:b((()=>[c(U,{modelValue:v(r).showShortLink,"onUpdate:modelValue":d[3]||(d[3]=e=>v(r).showShortLink=e)},null,8,["modelValue"])])),_:1}),c(T,{label:"短链有效期"},{tips:b((()=>[g(" 控制生成短链的有效期 ")])),default:b((()=>[c(L,{modelValue:v(r).linkExpireTimes,"onUpdate:modelValue":d[4]||(d[4]=e=>v(r).linkExpireTimes=e)},null,8,["modelValue"])])),_:1}),c(T,{label:"Referer 防盗链"},{tips:b((()=>[g(" 防盗链支持访问文件直链或短链时校验，如用户直接访问直链跳转后的存储源原始链接，无法进行校验和拦截。 ")])),default:b((()=>[c(A,{modelValue:v(r).refererType,"onUpdate:modelValue":d[5]||(d[5]=e=>v(r).refererType=e),label:"off"},{default:b((()=>[g("不启用 Referer 防盗链")])),_:1},8,["modelValue"]),c(A,{modelValue:v(r).refererType,"onUpdate:modelValue":d[6]||(d[6]=e=>v(r).refererType=e),label:"white_list"},{default:b((()=>[g("启用白名单")])),_:1},8,["modelValue"]),c(A,{modelValue:v(r).refererType,"onUpdate:modelValue":d[7]||(d[7]=e=>v(r).refererType=e),label:"black_list"},{default:b((()=>[g("启用黑名单")])),_:1},8,["modelValue"])])),_:1}),V(c(T,{label:"Referer 配置"},{default:b((()=>[c(A,{modelValue:v(r).refererAllowEmpty,"onUpdate:modelValue":d[8]||(d[8]=e=>v(r).refererAllowEmpty=e),label:!0},{default:b((()=>[g("允许 Referer 为空")])),_:1},8,["modelValue"]),c(A,{modelValue:v(r).refererAllowEmpty,"onUpdate:modelValue":d[9]||(d[9]=e=>v(r).refererAllowEmpty=e),label:!1},{default:b((()=>[g("禁止 Referer 为空")])),_:1},8,["modelValue"])])),_:1},512),[[x,"no"!==v(r).refererType]]),V(c(T,{label:"白名单"},{tips:b((()=>[g(" 每行输入一个域名，如： "),G,"white_list"===v(r).refererType?(s(),u("div",K," 每行输入一个域名，需要写协议头支持 * 通配符，如白名单 http://*zfile.vip 将只允许 http://zfile.vip、http://www.zfile.vip、http://demo.zfile.vip 等网站访问。 ")):y("",!0),"black_list"===v(r).refererType?(s(),u("div",$," 每行输入一个域名，需要写协议头，支持 * 通配符，如黑名单 http://*zfile.vip 将禁止所有如 http://zfile.vip、http://www.zfile.vip、http://demo.zfile.vip 等网站访问。 ")):y("",!0),i("div",Q,[Y,c(C,{onInput:v(R),modelValue:v(j),"onUpdate:modelValue":d[11]||(d[11]=e=>k(j)?j.value=e:null)},{suffix:b((()=>[v(j)&&!0===v(_)?(s(),h(v(I),{key:0,class:"w-4 text-green-500"})):v(j)&&!1===v(_)?(s(),h(v(z),{key:1,class:"w-4 text-red-500"})):y("",!0)])),_:1},8,["onInput","modelValue"])])])),default:b((()=>[c(C,{type:"textarea",onInput:v(R),rows:6,modelValue:v(r).refererValue,"onUpdate:modelValue":d[10]||(d[10]=e=>v(r).refererValue=e)},null,8,["onInput","modelValue"])])),_:1},512),[[x,"no"!==v(r).refererType]]),c(T,{label:"直链下载限制"},{tips:b((()=>[te,oe,ne,re,se,ue,i("span",null,[g('注意：如果你使用了反向代理，而不是直接访问的 ZFile 端口, 那你需要在反向代理处设置以下请求头为用户真实 IP："X-Forwarded-For", "X-Real-IP", "Proxy-Client-IP", "WL-Proxy-Client-IP", "HTTP_CLIENT_IP", "HTTP_X_FORWARDED_FOR"，不然不论谁访问 ZFile 都只能获取到反代服务器的 IP，同服务器一般是获取到 127.0.0.1 或 localhost, 这样此功能就无法正常使用!!! (辅助信息: 系统获取到您当前 IP 为 '),i("span",ie,w(v(f)),1),g(")")])])),default:b((()=>[ee,c(D,{modelValue:v(r).linkLimitSecond,"onUpdate:modelValue":d[12]||(d[12]=e=>v(r).linkLimitSecond=e),min:0,max:86400,step:1,size:"small",class:"mx-2"},null,8,["modelValue"]),le,c(D,{modelValue:v(r).linkDownloadLimit,"onUpdate:modelValue":d[13]||(d[13]=e=>v(r).linkDownloadLimit=e),min:0,max:9999999,step:1,size:"small",class:"mx-2"},null,8,["modelValue"]),ae])),_:1})])),_:1},8,["model"])),[[M,v(m)]]):y("",!0)])}}};export{pe as default};
