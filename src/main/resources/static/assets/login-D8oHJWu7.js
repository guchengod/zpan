import{av as e,aw as a,h as l,a9 as t,H as s}from"./base-BBwbuMrY.js";import{E as i,a as o}from"./form-item-BRZ0j9EI.js";/* empty css               */import"./tooltip-l0sNRNKZ.js";import{E as r}from"./popper-CF2HgFfE.js";import{E as n}from"./link-BCKfeXzf.js";import{E as d}from"./image-viewer-Cx9Jqjr0.js";/* empty css              */import{a as m,e as p,k as f,M as u,r as c,o as v,i as g,w as x,u as h,b as _,j as w,N as b,g as j,ab as y,P as k,Q as C}from"./index-B6LbRxzB.js";import U from"./zfile-basic-BAkVRYzJ.js";import{l as V,c as z,a as I,b as E}from"./login-KPnf46w9.js";import{i as M}from"./install-CWxdVj0R.js";import{_ as q}from"./plugin-vue_export-helper-BCo6x5W8.js";import{r as A}from"./CheckBadgeIcon-Cn-PgIwF.js";import{E as B}from"./request-B2kMKzxx.js";import{E as D}from"./index-KUFYR68Z.js";import"./castArray-Cx7RYULx.js";import"./_Uint8Array-FYYXr4ha.js";import"./_initCloneObject-CVPj0KFk.js";import"./index-Cd2l2kYr.js";import"./debounce-Da1en5bL.js";import"./scroll-Ck97Tz0c.js";import"./event-BwRzfsZt.js";function S(e,a){return m(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[f("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})])}const H=e=>(k("data-v-90ed368e"),e=e(),C(),e),O={class:"h-full min-h-screen bg-gray-100 text-gray-900 flex justify-center items-center"},P={class:"h-full lg:h-auto max-w-screen-lg bg-white shadow-xl sm:rounded-xl flex flex-1"},F=H((()=>f("div",{class:"flex-1 bg-gray-50 text-center hidden lg:flex rounded-l-xl"},[f("div",{class:"m-12 xl:m-16 w-full bg-contain bg-center bg-no-repeat zfile-login-logo"})],-1))),G={class:"w-full lg:w-1/2 xl:w-1/2 mt-10 p-6 sm:p-12"},J={class:"mt-0 flex flex-col items-center"},N={class:"text-2xl mt-0 xl:text-3xl font-extrabold box animate__animated animate__fadeInDown"},Q={class:"w-full flex-1"},R=y('<div class="my-12 relative" data-v-90ed368e><div class="absolute inset-0 flex items-center" aria-hidden="true" data-v-90ed368e><div class="w-full border-t text-gray-600" data-v-90ed368e></div></div><div class="relative flex justify-center text-sm" data-v-90ed368e><span class="px-2 bg-white text-sm leading-none text-gray-600 tracking-wide font-medium" data-v-90ed368e>管理员登录</span></div></div>',1),W={class:"flex space-x-5 w-full"},K=H((()=>f("br",null,null,-1))),L=H((()=>f("a",{target:"_blank",class:"text-blue-400",href:"https://docs.zfile.vip/question#reset-pwd"},"点击可前往文档查看操作方式",-1))),T=q({__name:"login",setup(y){let k=u(),C=c(!1),q=c(),H=c({username:"",password:"",verifyCode:"",verifyCodeUUID:""});let T=c({username:[{required:!0,message:"账号不能为空",trigger:["change","blur"]}],password:[{required:!0,message:"密码不能为空",trigger:["change","blur"]}]});const X=()=>{q.value.validate((e=>{e?(C.value=!0,I(H.value).then((e=>{window.localStorage.setItem("zfile-token",e.data),B({message:"登录成功",type:"success",duration:1e3,onClose(){k.push("/admin")}})})).catch((()=>{C.value=!1,$()}))):B.warning("请输入账号密码!")}))},Y=c("");V().then((e=>{Y.value=e.data}));const Z=c({}),$=()=>{E().then((e=>{Z.value=e.data,H.value.verifyCodeUUID=e.data.uuid}))};return $(),v((()=>{M().then((e=>{e.data||k.push("/install")})),z().then((e=>{e.data&&k.push("/admin")}))})),(u,c)=>{const v=D,y=i,k=d,V=n,z=r,I=s,E=o;return m(),p("div",O,[f("div",P,[F,f("div",G,[f("div",J,[f("h1",N,[f("img",{class:"w-16 cursor-pointer",onClick:c[0]||(c[0]=e=>{return a="https://github.com/zhaojun1998/zfile",void window.open(a);var a}),src:U})]),f("div",Q,[R,g(E,{onSubmit:c[6]||(c[6]=j((()=>{}),["prevent"])),ref_key:"loginFormRef",ref:q,rules:h(T),model:h(H),class:"zfile-login-form",size:"large"},{default:x((()=>[g(y,{class:"box animate__animated animate__fadeInUp",prop:"username"},{default:x((()=>[g(v,{placeholder:"管理员账号","prefix-icon":h(e),modelValue:h(H).username,"onUpdate:modelValue":c[1]||(c[1]=e=>h(H).username=e),modelModifiers:{trim:!0}},null,8,["prefix-icon","modelValue"])])),_:1}),g(y,{class:"box animate__animated animate__fadeInUp",prop:"password"},{default:x((()=>[g(v,{placeholder:"管理员密码",type:"password","show-password":"","prefix-icon":h(a),modelValue:h(H).password,"onUpdate:modelValue":c[2]||(c[2]=e=>h(H).password=e),modelModifiers:{trim:!0}},null,8,["prefix-icon","modelValue"])])),_:1}),"2fa"===h(Y)?(m(),_(y,{key:0,class:"box animate__animated animate__fadeInUp",prop:"verifyCode"},{default:x((()=>[g(v,{placeholder:"双因素认证验证码","prefix-icon":h(l),modelValue:h(H).verifyCode,"onUpdate:modelValue":c[3]||(c[3]=e=>h(H).verifyCode=e),modelModifiers:{trim:!0}},null,8,["prefix-icon","modelValue"])])),_:1})):"image"===h(Y)?(m(),_(y,{key:1,class:"box animate__animated animate__fadeInUp",prop:"verifyCode"},{default:x((()=>[f("div",W,[g(v,{class:"flex-1",placeholder:"请输入验证码","prefix-icon":h(S),modelValue:h(H).verifyCode,"onUpdate:modelValue":c[4]||(c[4]=e=>h(H).verifyCode=e),modelModifiers:{trim:!0}},null,8,["prefix-icon","modelValue"]),g(k,{src:h(Z)?.imgBase64,onClick:c[5]||(c[5]=e=>$())},null,8,["src"])])])),_:1})):w("",!0),g(y,{class:"box animate__animated animate__fadeInUp float-right"},{default:x((()=>[g(z,{class:"item",effect:"dark",placement:"left"},{content:x((()=>[b(" 将配置文件 application.properties 中 zfile.debug 修改为 true, 重启后访问首页即可重置密码 "),K,L])),default:x((()=>[g(V,{icon:h(t),underline:!1,class:"zfile-float-right"},{default:x((()=>[b("忘记密码")])),_:1},8,["icon"])])),_:1})])),_:1}),g(y,{class:"clear-right"},{default:x((()=>[g(I,{loading:h(C),class:"w-full mb-0","native-type":"submit",type:"primary",icon:h(A),onClick:X},{default:x((()=>[b("登录")])),_:1},8,["loading","icon"])])),_:1})])),_:1},8,["rules","model"])])])])])])}}},[["__scopeId","data-v-90ed368e"]]);export{T as default};
